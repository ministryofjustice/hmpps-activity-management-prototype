{% extends "layout_hmpps.html" %}
{% block pageTitle %}
Activities Management prototype
{% endblock %}

{% block primaryNavigation %} {% endblock %}

{% block beforeContent %}
{{govukBackLink({
text: "Back",
"href": "javascript: window.history.go(-1)"
})}}
{% endblock %}

{% block content %}
<div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
        <h1 class="govuk-heading-l">
            Application details
        </h1>
        
        <dl class="govuk-summary-list govuk-!-margin-bottom-8">
            <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">
                    Prisoner
                </dt>
                <dd class="govuk-summary-list__value">
                    {% set prisoner = application['selected-prisoner']|getPrisonerDetails %}
                    {{prisoner.name.firstname}} {{prisoner.name.surname}}
                </dd>
            </div>
            <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">
                    Activity
                </dt>
                <dd class="govuk-summary-list__value">
                    {% set activity = application['activity']|getActivityDetails %}
                    {{activity.name}}
                </dd>
            </div>
            <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">
                    Application date
                </dt>
                <dd class="govuk-summary-list__value">
                    {{application['date']|convertShortDateToLongDate}}
                </dd>
            </div>
            <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">
                    Application made by
                </dt>
                <dd class="govuk-summary-list__value">
                    {% if application['applicant'] == 'prisoner' %}
                    Prisoner
                    {% else %}
                    Someone else
                    {% endif %}
                </dd>
            </div>
            <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">
                    Eligibility
                </dt>
                <dd class="govuk-summary-list__value">
                    {% if application.eligible == 'yes' %}
                    <span class="govuk-tag govuk-tag--green">Eligible</span>
                    {% elif application.eligible == 'no' %}
                    <span class="govuk-tag govuk-tag--red">Not eligible</span>
                    {% else %}
                    <span class="govuk-tag govuk-tag--yellow">Further checks needed</span>
                    {% endif %}
                </dd>
            </div>
            {% if application['eligibility-check-date'] %}
            <div class="govuk-summary-list__row">
                <dt class="govuk-summary-list__key">
                    Eligibility checked
                </dt>
                <dd class="govuk-summary-list__value">
                    {{application['eligibility-check-date']|convertShortDateToLongDate}}
                </dd>
            </div>
            {% endif %}
        </dl>

        <form method="post" class="govuk-!-margin-top-8">
            {{govukRadios({
            idPrefix: "application-status",
            name: "new-application[status]",
            fieldset: {
            legend: {
            text: "What do you want to do with this application?",
            isPageHeading: true,
            classes: "govuk-fieldset__legend--m"
            }
            },
            items: [
            {
            value: "allocate",
            html: "<b>Allocate the prisoner</b> to " + activity.name
            },
            {
            value: "accept",
            html: "<b>Create a note</b> on the application"
            },
            {
            value: "reject",
            html: "<b>Reject</b> the application"
            }
            ]
            })}}

            {{ govukButton({
            text: "Submit decision"
            }) }}
        </form>
    </div>
</div>

{% endblock %}